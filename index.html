<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒŠ ìš©ë‚¨ ëŒ€ì‹œë³´ë“œ</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',-apple-system,sans-serif;background:#0f172a;color:#e2e8f0;min-height:100vh}

/* Login */
.login-screen{display:flex;align-items:center;justify-content:center;min-height:100vh}
.login-box{background:#1e293b;border:1px solid #334155;border-radius:20px;padding:40px;text-align:center;width:320px}
.login-box h2{font-size:32px;margin-bottom:8px}
.login-box p{color:#64748b;font-size:14px;margin-bottom:24px}
.login-box input{width:100%;padding:12px 16px;border-radius:12px;border:1px solid #334155;background:#0f172a;color:#e2e8f0;font-size:20px;text-align:center;letter-spacing:8px;outline:none}
.login-box input:focus{border-color:#3b82f6}
.login-box button{margin-top:16px;width:100%;padding:12px;border-radius:12px;border:none;background:#3b82f6;color:white;font-size:15px;font-weight:600;cursor:pointer}
.login-box button:hover{background:#2563eb}
.login-error{color:#f87171;font-size:13px;margin-top:12px;display:none}

/* Dashboard */
.dash{display:none;padding:24px;max-width:960px;margin:0 auto}
.dash.active{display:block}

.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;flex-wrap:wrap;gap:8px}
.header h1{font-size:24px;font-weight:700}
.header .meta{color:#64748b;font-size:13px;text-align:right}
.refresh-dot{display:inline-block;width:8px;height:8px;border-radius:50%;background:#22c55e;margin-right:6px;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.4}}

/* Overall */
.overall{background:#1e293b;border:1px solid #334155;border-radius:16px;padding:24px;margin-bottom:24px;text-align:center}
.overall-pct{font-size:56px;font-weight:800;color:#3b82f6}
.overall-label{color:#94a3b8;font-size:14px;margin-top:4px}
.overall-bar{background:#334155;border-radius:10px;height:12px;margin-top:16px;overflow:hidden}
.overall-fill{height:100%;border-radius:10px;background:linear-gradient(90deg,#3b82f6,#22c55e);transition:width .5s}
.overall-detail{color:#64748b;font-size:13px;margin-top:8px}

/* Project cards */
.project{background:#1e293b;border:1px solid #334155;border-radius:16px;padding:20px;margin-bottom:16px}
.project-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.project-name{font-size:17px;font-weight:700}
.project-pct{font-size:15px;font-weight:700;color:#3b82f6}
.project-desc{color:#94a3b8;font-size:13px;margin-bottom:12px}
.project-bar{background:#334155;border-radius:8px;height:8px;overflow:hidden;margin-bottom:14px}
.project-fill{height:100%;border-radius:8px;transition:width .5s}

.cat{display:flex;align-items:center;gap:10px;padding:8px 0;border-top:1px solid #1e293b}
.cat-icon{font-size:14px;width:20px;text-align:center}
.cat-name{font-size:14px;flex:1}
.cat-count{font-size:13px;color:#94a3b8;min-width:60px;text-align:right}
.cat-minibar{width:80px;height:6px;background:#334155;border-radius:4px;overflow:hidden}
.cat-minifill{height:100%;border-radius:4px}

.done .project-pct{color:#22c55e}
.done .project-fill{background:#22c55e}
.done .project-header{opacity:.7}

.status-badge{display:inline-block;padding:2px 10px;border-radius:8px;font-size:11px;font-weight:600}
.sb-done{background:#166534;color:#86efac}
.sb-wip{background:#1e3a5f;color:#93c5fd}
.sb-todo{background:#713f12;color:#fde68a}

@media(max-width:480px){
  .dash{padding:16px}
  .overall-pct{font-size:44px}
  .cat-minibar{width:50px}
  .header h1{font-size:20px}
}
</style>
</head>
<body>

<div class="login-screen" id="loginScreen">
  <div class="login-box">
    <h2>ğŸŒŠ</h2>
    <p>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
    <input type="password" id="pwInput" maxlength="10" placeholder="Â·Â·Â·Â·" autofocus>
    <button onclick="tryLogin()">í™•ì¸</button>
    <div class="login-error" id="loginError">ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤</div>
  </div>
</div>

<div class="dash" id="dashboard">
  <div class="header">
    <h1>ğŸŒŠ ìš©ë‚¨ ëŒ€ì‹œë³´ë“œ</h1>
    <div class="meta"><span class="refresh-dot"></span>ìë™ ê°±ì‹  ì¤‘<br><span id="updatedAt"></span></div>
  </div>
  <div id="content"></div>
</div>

<script>
const PW='1415', KEY='yn_auth';

function tryLogin(){
  if(document.getElementById('pwInput').value===PW){
    sessionStorage.setItem(KEY,'1'); show();
  } else {
    document.getElementById('loginError').style.display='block';
    document.getElementById('pwInput').value='';
  }
}
document.getElementById('pwInput').addEventListener('keydown',e=>{if(e.key==='Enter')tryLogin()});

function show(){
  document.getElementById('loginScreen').style.display='none';
  document.getElementById('dashboard').classList.add('active');
  loadData();
  setInterval(loadData, 15000);
}

async function loadData(){
  try{
    const r=await fetch('progress.json?t='+Date.now());
    const d=await r.json();
    render(d);
  }catch(e){console.error(e)}
}

function render(d){
  const ts=new Date(d.lastUpdated);
  document.getElementById('updatedAt').textContent='ì—…ë°ì´íŠ¸: '+ts.toLocaleString('ko-KR',{timeZone:'Asia/Seoul'});

  let totalDone=0, totalAll=0;
  const wip=d.projects.filter(p=>p.status==='wip');
  const done=d.projects.filter(p=>p.status==='done');

  wip.forEach(p=>p.categories.forEach(c=>{totalDone+=c.done;totalAll+=c.total}));

  const pct=totalAll?Math.round(totalDone/totalAll*100):0;

  let h=`
    <div class="overall">
      <div class="overall-pct">${pct}%</div>
      <div class="overall-label">í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì‘ì—… ì „ì²´ ì§„í–‰ë¥ </div>
      <div class="overall-bar"><div class="overall-fill" style="width:${pct}%"></div></div>
      <div class="overall-detail">${totalDone} / ${totalAll} í•­ëª© ì™„ë£Œ</div>
    </div>
  `;

  wip.forEach(p=>{
    let pd=0,pt=0;
    p.categories.forEach(c=>{pd+=c.done;pt+=c.total});
    const pp=pt?Math.round(pd/pt*100):0;
    const color=pp===100?'#22c55e':pp>0?'#3b82f6':'#f59e0b';

    h+=`<div class="project">
      <div class="project-header">
        <span class="project-name">${p.name}</span>
        <span class="project-pct" style="color:${color}">${pp}%</span>
      </div>
      <div class="project-desc">${p.description}</div>
      <div class="project-bar"><div class="project-fill" style="width:${pp}%;background:${color}"></div></div>`;

    p.categories.forEach(c=>{
      const cp=c.total?Math.round(c.done/c.total*100):0;
      const icon=c.status==='done'?'âœ…':c.status==='wip'?'ğŸ”§':'â³';
      const fc=c.status==='done'?'#22c55e':c.status==='wip'?'#3b82f6':'#f59e0b';
      h+=`<div class="cat">
        <span class="cat-icon">${icon}</span>
        <span class="cat-name">${c.name} ${c.note?'<span style="color:#64748b;font-size:12px">'+c.note+'</span>':''}</span>
        <span class="cat-count">${c.done}/${c.total}</span>
        <div class="cat-minibar"><div class="cat-minifill" style="width:${cp}%;background:${fc}"></div></div>
      </div>`;
    });
    h+=`</div>`;
  });

  if(done.length){
    h+=`<div style="color:#64748b;font-size:13px;margin:20px 0 12px;text-transform:uppercase;letter-spacing:1px">ì™„ë£Œëœ í”„ë¡œì íŠ¸</div>`;
    done.forEach(p=>{
      h+=`<div class="project done">
        <div class="project-header">
          <span class="project-name">${p.name} <span class="status-badge sb-done">ì™„ë£Œ</span></span>
          <span class="project-pct" style="color:#22c55e">${p.completedAt||''}</span>
        </div>
        <div class="project-desc">${p.description}</div>
        <div class="project-bar"><div class="project-fill" style="width:100%;background:#22c55e"></div></div>
      </div>`;
    });
  }

  document.getElementById('content').innerHTML=h;
}

if(sessionStorage.getItem(KEY)==='1') show();
</script>
</body>
</html>
